<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/google-map/google-map.html">
<link rel="import" href="../bower_components/google-map/google-map-marker.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<dom-module id="polymer-demo">
    <style>
    </style>
    <template>
        <paper-drawer-panel>
            <paper-header-panel drawer>
                <paper-toolbar></paper-toolbar>
                <div>
                    <paper-input label="Buscar" type="search" placeholder="Nombre del centro"  value="{{filterVal::input}}">
                    </paper-input>
                </div>
            </paper-header-panel>
            <paper-header-panel main>
                <paper-toolbar class="medium-tall">
                    <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
                    <span class="title">Listado de centros Grid</span>
                     <paper-tabs id="tabs" class="bottom self-end" selected="{{selected}}">
                        <paper-tab>Mapa</paper-tab>
                        <paper-tab>Listado</paper-tab>
                    </paper-tabs>
                </paper-toolbar>
                <div>
                    <iron-pages selected="{{selected}}">
                        <div>
                            <google-map id="map" latitude="43.8261754" longitude="17.1714736" zoom="13" fit-to-markers>
                                <template is="dom-repeat" items="{{centrosGrid}}" filter="{{_filter(filterVal)}}" >
                                    <google-map-marker latitude="{{item.lat}}" longitude="{{item.long}}" title="{{item.name}}"></google-map-marker>
                                </template>
                            </google-map>
                        </div>
                        <div>
                            <template is="dom-repeat" items="{{centrosGrid}}" filter="{{_filter(filterVal)}}">
                                <paper-card heading="{{item.name}}">
                                    <div class="card-content">{{item.country}}</div>
                                </paper-card>
                            </template>
                        </div>
                    </iron-pages>
               </div>           
            </paper-header-panel>
        </paper-drawer-panel>
    </template>
</dom-module>
<script>
    //llamamos al objeto que  inicializa el componente.
    Polymer({
        is:"polymer-demo",
        ready: function(){
            this.$.map.style.height = window.innerHeight -128;
            this.$.tabs.selected = 0;
        },
        properties: {
            centrosGrid:{
                type: Array,
                value: function(){
                    var array = new Array();  
                    array.push({
                        "name":"100 Percent IT Ltd",
                        "country": "Reino Unido",
                        "lat":"51.3885823",
                        "long":"-1.361035"
                    });
                    array.push({
                        "name":"UNIZAR / BIFI",
                        "country": "España",
                        "lat":"41.6917474",
                        "long":"-1.2072398"
                    });
                    array.push({
                        "name":"Cyfronet (NGI PL)",
                        "country": "Polonia",
                        "lat":"50.0469018",
                        "long":"19.864791"
                    });
                    array.push({
                        "name":"CESGA",
                        "country": "España",
                        "lat":"42.8802351",
                        "long":"-8.5622792"
                    });
                    array.push({
                        "name":"CESNET-MetaCloud",
                        "country": "República Checka",
                        "lat":"50.0598058",
                        "long":"14.3255418"
                    });
                    array.push({
                        "name":"FZ Jülich",
                        "country": "Alemania",
                        "lat":"50.928645",
                        "long":"6.2896754"
                    });
                    array.push({
                        "name":"GWDG",
                        "country": "Alemania",
                        "lat":"51.5370234",
                        "long":"9.8568133"
                    });
                    array.push({
                        "name":"CSIC/IFCA",
                        "country": "España",
                        "lat":"43.4614014",
                        "long":"-3.8461564"
                    });
                    array.push({
                        "name":"GRNET",
                        "country": "Grecia",
                        "lat":"37.9908997",
                        "long":"23.7033199"
                    });
                    array.push({
                        "name":"II SAS",
                        "country": "Austria",
                        "lat":"48.1359244",
                        "long":"16.9758347"
                    });
                    array.push({
                        "name":"INFN - Catania",
                        "country": "Italia",
                        "lat":"37.4908267",
                        "long":"15.0074731"
                    });
                    array.push({
                        "name":"INFN - Bari",
                        "country": "Italia",
                        "lat":"41.0922226",
                        "long":"16.7352308"
                    });
                    array.push({
                        "name":"INFN-PADOVA",
                        "country": "Italia",
                        "lat":"45.4066029",
                        "long":"11.8212059"
                    });
                    array.push({
                        "name":"MTA SZTAKI",
                        "country": "Hungría",
                        "lat":"47.4813602",
                        "long":"18.9902207"
                    });
                    array.push({
                        "name":"TUBITAK ULAKBIM",
                        "country": "Turquía",
                        "lat":"39.9035557",
                        "long":"32.6226815"
                    });
                    array.push({
                        "name":"UKIM",
                        "country": "Macedonia",
                        "lat":"41.9991965",
                        "long":"21.3548506"
                    });
                    array.push({
                        "name":"CETA-CIEMAT",
                        "country": "España",
                        "lat":"39.4950124",
                        "long":"-6.2983804"
                    });
                    array.push({
                        "name":"IPHC",
                        "country": "Francia",
                        "lat":"48.5750629",
                        "long":"7.6923526"
                    });
                    array.push({
                        "name":"NCG-INGRID-PT / LIP",
                        "country": "Portugal",
                        "lat":"38.7437396",
                        "long":"-9.2302434"
                    });
                    array.push({
                        "name":"Polythecnic University of Valencia, I3M",
                        "country": "España",
                        "lat":"39.4690455",
                        "long":"-0.4364237"
                    });
                    return array;
                },
                selectOption: {
                    type: Number,
                    value: 0,
                    observer: "activateOption"
                }
            }
        },
        _filter: function(val) {  
               return function(item) {
                    if (!val) return true;
                        if (!item) return false;
                            return (item.name.toLowerCase() && ~item.name.toLowerCase().indexOf(val.toLowerCase()));
                };
        }
    });
</script>